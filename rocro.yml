---
inspecode:

  tasks:

    - name: yamllint_linter
      type: docker-build
      dockerfile: '.rocro/yamllint/linter.Dockerfile'
      options:
        --context: .
        --build-arg: [OUTDIR=/.reports]
      artifacts:
        uploads:
          - stage: linter-stage
            path: '/.reports/yamllint.issues'
      reports:
        - stage: linter-stage
          path: '/.reports/yamllint.issues'
          format:
            type: example
            path: '.rocro/yamllint/issues.example'
      thresholds: {num-issues: 999}

    - name: yamllint_sarify
      pre-tasks: yamllint_linter
      type: docker-build
      dockerfile: '.rocro/yamllint/sarify.Dockerfile'
      options:
        --context: .
        --build-arg: [OUTDIR=/.reports]
      artifacts:
        downloads:
          source:
            task: yamllint_linter
            stage: linter-stage
            path: '/.reports/yamllint.issues'
          destination:
            path: '.rocro/yamllint/yamllint.issues'
        uploads:
          - stage: sarify-stage
            path: '/.reports/yamllint.sarif'
      reports:
        - stage: sarify-stage
          path: '/.reports/yamllint.sarif'
      thresholds: {num-issues: 999}
